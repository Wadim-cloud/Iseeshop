import{n as Pe,a as i,c as Ae,t as _,b as J}from"../chunks/DxolCNix.js";import"../chunks/Ci8d3Fat.js";import{p as ae,ao as he,A as a,I as b,ak as fe,ap as pe,aq as j,x as e,a as oe,aP as Te,av as Z,as as f,ar as n,at as p,o as Me,aK as $e,w as ze,aH as Le}from"../chunks/B668RH8u.js";import{e as B,s as _e,h as Ee}from"../chunks/DhXqswRN.js";import{i as h}from"../chunks/CoxfEDN7.js";import{s as N}from"../chunks/BavnsP6q.js";import{t as M,f as U,a as xe}from"../chunks/CfWLuewf.js";import{i as se}from"../chunks/CHu_v1B0.js";import{s as Ge,a as Re}from"../chunks/BHuW5wU9.js";import{p as Ve}from"../chunks/CJMrvfOc.js";import{C as He}from"../chunks/Cisl1x4j.js";import{p as ee}from"../chunks/BfDDsPvW.js";import{s as te}from"../chunks/AJiKPocd.js";import{s as Ne}from"../chunks/kt7n16z5.js";import{g as Y,i as me}from"../chunks/ZC7F_AQJ.js";var Ue=Pe('<svg class="spinner svelte-rv4oqt" viewBox="0 0 50 50"><circle cx="25" cy="25" r="20" fill="none" stroke="currentColor" stroke-width="5" class="svelte-rv4oqt"></circle></svg>');function be(R,k){ae(k,!1);const x=b();let C=ee(k,"size",8,"md"),I=ee(k,"color",8,"currentColor");he(()=>fe(C()),()=>{a(x,{sm:"16px",md:"24px",lg:"32px"}[C()])}),pe(),se();var r=Ue();j(()=>Ne(r,`width: ${e(x)}; height: ${e(x)}; color: ${I()}`)),i(R,r),oe()}var Be=_('<div class="error-message svelte-r03bgn" role="alert"> </div>'),je=_('<div class="modal-overlay svelte-r03bgn"><div class="modal svelte-r03bgn"><button class="close-button svelte-r03bgn" aria-label="Close authentication modal"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" stroke-linecap="round"></path></svg></button> <h2 class="svelte-r03bgn">Sign In to Pexos</h2> <div class="provider-buttons svelte-r03bgn"><button class="provider-button google svelte-r03bgn" aria-label="Sign in with Google"><span class="provider-icon svelte-r03bgn"><img src="chimp.jpg" alt="Google" class="provider-pictogram svelte-r03bgn"></span> <!></button> <button class="provider-button github svelte-r03bgn" aria-label="Sign in with GitHub"><span class="provider-icon svelte-r03bgn"><img src="frogger.jpg" alt="GitHub" class="provider-pictogram svelte-r03bgn"></span> <!></button></div> <!></div></div>');function De(R,k){ae(k,!1);let x=ee(k,"show",12);const C=Te();let I=b(null),r=b(null),q=b(null);async function w(c){a(r,c),a(q,null);try{const{error:d}=await te.auth.signInWithOAuth({provider:c,options:{redirectTo:`${window.location.origin}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});if(d)throw d;C("authSuccess")}catch(d){const S=d instanceof Error?d.message:"Login failed";console.error(`${c} login error:`,d),a(q,S),C("authError",{message:S})}finally{a(r,null),a(I,null)}}function $(c){console.log(`Provider clicked: ${c}`),a(I,c),w(c)}he(()=>fe(x()),()=>{console.log("AuthModal show prop:",x())}),pe(),se();var P=Ae(),V=Z(P);{var D=c=>{var d=je(),S=f(d),H=f(S),z=n(H,4),A=f(z),K=n(f(A),2);{var F=t=>{be(t,{size:"sm",color:"white"})},Q=t=>{var m=J("Sign in with Google");i(t,m)};h(K,t=>{e(r)==="google"?t(F):t(Q,!1)})}p(A);var o=n(A,2),v=n(f(o),2);{var g=t=>{be(t,{size:"sm",color:"white"})},u=t=>{var m=J("Sign in with GitHub");i(t,m)};h(v,t=>{e(r)==="github"?t(g):t(u,!1)})}p(o),p(z);var L=n(z,2);{var y=t=>{var m=Be(),O=f(m,!0);p(m),j(()=>_e(O,e(q))),i(t,m)};h(L,t=>{e(q)&&t(y)})}p(S),p(d),j(()=>{A.disabled=e(r)==="google",o.disabled=e(r)==="github"}),B("click",H,()=>{console.log("Close button clicked"),x(!1),a(I,null),a(q,null)}),B("click",A,()=>$("google")),B("click",o,()=>$("github")),M(3,S,()=>U,()=>({y:100,duration:400})),M(3,d,()=>xe,()=>({duration:300})),i(c,d)};h(V,c=>{x()&&c(D)})}i(R,P),oe()}var Oe=_('<meta name="description" content="A collaborative creative platform for drawing, plotting, selling, and solving challenges." class="svelte-1q0bxm1">'),We=_('<div class="loader-container svelte-1q0bxm1" role="status" aria-live="polite"><div class="loader-overlay svelte-1q0bxm1"></div> <div class="loader-content svelte-1q0bxm1"><img src="/logo192.png" alt="Pexos Logo" class="loader-logo floating svelte-1q0bxm1"> <p class="loader-text svelte-1q0bxm1">Initializing Pexos...</p></div></div>'),Je=_('<div class="svelte-1q0bxm1"><img src="/logo192.png" alt="Pexos Logo" class="hero-logo svelte-1q0bxm1"></div>'),Ke=_('<div class="svelte-1q0bxm1"><h1 class="hero-title svelte-1q0bxm1">Pexos</h1></div>'),Fe=_('<div class="svelte-1q0bxm1"><p class="hero-subtitle svelte-1q0bxm1">A Collaborative Creative Platform</p></div>'),Qe=_('<div class="headline-section svelte-1q0bxm1"><h2 class="hero-headline svelte-1q0bxm1"><!> Create, Plot, Sell, and Solve Community Challenges</h2></div>'),Xe=_('<div class="svelte-1q0bxm1"><button class="sign-in-button svelte-1q0bxm1" aria-label="Sign in to Pexos"><span class="button-icon svelte-1q0bxm1"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="svelte-1q0bxm1"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm4.59-12.42L10 14.17l-2.59-2.58L6 13l4 4 8-8z" fill="white" class="svelte-1q0bxm1"></path></svg></span> Sign In</button></div>'),Ye=_('<div class="hero-container svelte-1q0bxm1"><div><!></div> <div></div> <div></div> <div></div> <div></div> <div class="hero-content svelte-1q0bxm1"><!> <!> <!> <!> <!></div></div>'),Ze=_('<div class="modal-debug svelte-1q0bxm1">Modal should be visible</div> <!>',1),et=_("<!> <!>",1);function ht(R,k){ae(k,!1);const[x,C]=Ge(),I=()=>Re(Ve,"$page",x);let r=b(!1),q=b(!0),w=b(null),$=b(!1),P=b(!1),V=b(!1),D=b(!1),c=b(!1),d=b(!1);Me(async()=>{console.log("Root page mounted");try{const{data:{session:o},error:v}=await te.auth.getSession();v&&console.error("Session check error:",v.message),a(w,o),console.log("Initial session:",e(w)?"User logged in":"No user"),setTimeout(()=>{a(q,!1),setTimeout(()=>a($,!0),300),setTimeout(()=>a(P,!0),800),setTimeout(()=>a(V,!0),1300),setTimeout(()=>a(D,!0),1800),setTimeout(()=>a(c,!0),2200),setTimeout(()=>a(d,!0),2800)},1e3);const g=I().url.searchParams.get("redirect");g&&(console.log("Redirect param:",g),localStorage.setItem("sb-redirect",decodeURIComponent(g)),e(w)?(console.log("User already signed in, redirecting to:",g),Y(decodeURIComponent(g),{replaceState:!0})):(console.log("No session, showing auth modal"),a(r,!0)));const{data:u}=te.auth.onAuthStateChange(async(L,y)=>{var t;if(console.log("Auth state changed:",L,(t=y==null?void 0:y.user)==null?void 0:t.email),a(w,y),L==="SIGNED_IN"&&y){await me();const m=localStorage.getItem("sb-redirect")||"/";localStorage.removeItem("sb-redirect"),console.log("Redirecting after sign-in:",m),Y(m,{replaceState:!0})}});return()=>u.subscription.unsubscribe()}catch(o){console.error("Session check failed:",o),a(q,!1)}});function S(){console.log("Sign In button clicked, setting showAuthModal to true"),a(r,!0),console.log("showAuthModal state:",e(r))}se();var H=et();Ee(o=>{var v=Oe();$e.title="Pexos - Creative Platform",i(o,v)});var z=Z(H);{var A=o=>{var v=We();i(o,v)},K=o=>{var v=Ye(),g=f(v);let u;var L=f(g);He(L,{}),p(g);var y=n(g,2);let t;var m=n(y,2);let O;var le=n(m,2);let re;var ie=n(le,2);let ne;var ve=n(ie,2),ce=f(ve);{var ye=s=>{var l=Je();M(1,l,()=>U,()=>({y:50,duration:1e3})),i(s,l)};h(ce,s=>{e(V)&&s(ye)})}var de=n(ce,2);{var qe=s=>{var l=Ke();M(1,l,()=>U,()=>({y:50,duration:1e3,delay:200})),i(s,l)};h(de,s=>{e(V)&&s(qe)})}var ge=n(de,2);{var we=s=>{var l=Fe();M(1,l,()=>U,()=>({y:30,duration:800,delay:300})),i(s,l)};h(ge,s=>{e(D)&&s(we)})}var ue=n(ge,2);{var Se=s=>{var l=Qe(),T=f(l),E=f(T);{var X=G=>{var W=J();j(()=>_e(W,`Welcome back, ${e(w).user.email??""}!`)),i(G,W)},Ie=G=>{var W=J("Join the Pexos community and unleash your creativity!");i(G,W)};h(E,G=>{e(w)?G(X):G(Ie,!1)})}Le(),p(T),p(l),M(1,l,()=>U,()=>({x:-100,duration:1e3,delay:400})),i(s,l)};h(ue,s=>{e(c)&&s(Se)})}var ke=n(ue,2);{var Ce=s=>{var l=Xe(),T=f(l);p(l),B("click",T,S),B("keydown",T,E=>(E.key==="Enter"||E.key==="Space")&&S()),M(1,l,()=>xe,()=>({duration:800,delay:500})),i(s,l)};h(ke,s=>{!e(r)&&!e(w)&&e(d)&&s(Ce)})}p(ve),p(v),j((s,l,T,E,X)=>{u=N(g,1,"shader-layer svelte-1q0bxm1",null,u,s),t=N(y,1,"overlay-layer svelte-1q0bxm1",null,t,l),O=N(m,1,"deco-element top-right svelte-1q0bxm1",null,O,T),re=N(le,1,"deco-element bottom-left svelte-1q0bxm1",null,re,E),ne=N(ie,1,"deco-element center-glow svelte-1q0bxm1",null,ne,X)},[()=>({active:e($)}),()=>({"fade-out":e($)}),()=>({visible:e(P)}),()=>({visible:e(P)}),()=>({visible:e(P)})],ze),i(o,v)};h(z,o=>{e(q)?o(A):o(K,!1)})}var F=n(z,2);{var Q=o=>{var v=Ze(),g=n(Z(v),2);De(g,{get show(){return e(r)},set show(u){a(r,u)},$$events:{authSuccess:async()=>{console.log("Auth success event"),await me();const u=localStorage.getItem("sb-redirect")||"/";localStorage.removeItem("sb-redirect"),console.log("Redirecting after auth success:",u),Y(u,{replaceState:!0})},authError:({detail:u})=>{console.log("Auth error:",u.message),a(r,!1)}},$$legacy:!0}),i(o,v)};h(F,o=>{e(r)&&o(Q)})}i(R,H),oe(),C()}export{ht as component};
