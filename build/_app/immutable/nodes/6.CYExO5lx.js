import{t as u,a as l,n as St,c as ut}from"../chunks/DxolCNix.js";import"../chunks/Ci8d3Fat.js";import{p as at,a as rt,ar as d,as as s,at as e,aq as N,aH as lt,x as w,w as ht,aP as jt,ao as Gt,A as qt,I as Rt,ak as yt,ap as Zt,av as et,aK as Ft}from"../chunks/B668RH8u.js";import{e as m,s as X,h as Yt}from"../chunks/DhXqswRN.js";import{g as Nt}from"../chunks/ZC7F_AQJ.js";import{i as st}from"../chunks/CHu_v1B0.js";import{s as pt,a as Y}from"../chunks/BHuW5wU9.js";import{i as j}from"../chunks/CoxfEDN7.js";import{e as nt,i as ft}from"../chunks/Dxuc275j.js";import{a as O}from"../chunks/DGKrTPFL.js";import{s as _t}from"../chunks/BavnsP6q.js";import{s as Dt}from"../chunks/Bfc47y5P.js";import{b as xt}from"../chunks/B1fvfluE.js";import{p as M}from"../chunks/BfDDsPvW.js";import{c as vt,a as Lt,b as Et,l as it}from"../chunks/ByQ5wDhZ.js";import{t as Mt,f as Ut,s as Vt}from"../chunks/CfWLuewf.js";import{s as It}from"../chunks/AJiKPocd.js";import{w as T}from"../chunks/CxeLWBhm.js";var $t=u('<div class="loading svelte-9n3om3">Loading gallery...</div>'),Jt=u('<div class="error svelte-9n3om3"> </div>'),Qt=u('<div class="no-content svelte-9n3om3">No drawings available.</div>'),Tt=St('<path d="M9 20a1 1 0 100-2 1 1 0 000 2z" fill="#4CAF50"></path><path d="M20 20a1 1 0 100-2 1 1 0 000 2z" fill="#4CAF50"></path><path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6" stroke="#4CAF50"></path>',1),Xt=St('<path d="M9 20a1 1 0 100-2 1 1 0 000 2z"></path><path d="M20 20a1 1 0 100-2 1 1 0 000 2z"></path><path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"></path>',1),Kt=u('<div class="gallery-item svelte-9n3om3"><img class="gallery-image svelte-9n3om3" loading="lazy"> <div class="gallery-meta svelte-9n3om3"><div class="gallery-stats svelte-9n3om3"><button class="like-button svelte-9n3om3"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333" class="svelte-9n3om3"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg> <span> </span></button></div> <div class="button-group svelte-9n3om3"><button class="preview-button svelte-9n3om3"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg> Preview</button> <button class="preview-button preview-3d svelte-9n3om3"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path><path d="M12 18a6 6 0 100-12 6 6 0 000 12z"></path><path d="M12 14a2 2 0 100-4 2 2 0 000 4z"></path></svg> 3D View</button> <button><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333"><!></svg> </button></div></div></div>'),Ot=u('<div class="gallery-grid svelte-9n3om3"></div>'),te=u('<div class="modal svelte-9n3om3"><div class="modal-content svelte-9n3om3"><img alt="Drawing preview" class="svelte-9n3om3"> <button class="close-button svelte-9n3om3">×</button></div></div>'),ee=u('<div class="modal svelte-9n3om3"><div class="modal-content modal-3d svelte-9n3om3"><div class="preview-3d-container svelte-9n3om3"><div class="preview-3d-placeholder svelte-9n3om3"><img alt="3D preview" class="preview-texture svelte-9n3om3"> <div class="preview-3d-object svelte-9n3om3"><span>3D Preview</span></div></div></div> <button class="close-button svelte-9n3om3">×</button></div></div>'),ae=u('<div class="gallery-wrapper svelte-9n3om3"><!> <!> <!></div>');function re(G,a){at(a,!1);const[g,v]=pt(),n=()=>Y(Lt,"$cartStore",g);let q=M(a,"drawings",8),I=M(a,"onLike",8),L=M(a,"onPreview",8),A=M(a,"on3DPreview",8),B=M(a,"loading",8),H=M(a,"error",8),z=M(a,"selectedDrawing",8),E=M(a,"selected3DDrawing",8),i=M(a,"onClosePreview",8),C=M(a,"onClose3DPreview",8);const S="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjgiIGZpbGw9IiNjY2MiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPkxvYWRpbmc8L3RleHQ+PC9zdmc+";function c(t){return n().some(r=>r.drawingId===t)}function k(t){c(t.id)?vt.removeFromCart(t.id):vt.addToCart(t)}st();var _=ae(),y=s(_);{var R=t=>{var r=$t();l(t,r)},Z=(t,r)=>{{var p=D=>{var P=Jt(),b=s(P,!0);e(P),N(()=>X(b,H())),l(D,P)},h=(D,P)=>{{var b=f=>{var J=Qt();l(f,J)},x=f=>{var J=Ot();nt(J,5,q,tt=>tt.id,(tt,F)=>{var ct=Kt(),K=s(ct);O(K,"src",S);var bt=d(K,2),dt=s(bt),gt=s(dt),wt=d(s(gt),2),At=s(wt,!0);e(wt),e(gt),e(dt);var kt=d(dt,2),Pt=s(kt),Ct=d(Pt,2),ot=d(Ct,2),mt=s(ot),zt=s(mt);{var Bt=U=>{var $=Tt();lt(2),l(U,$)},Ht=U=>{var $=Xt();lt(2),l(U,$)};j(zt,U=>{c(w(F).id)?U(Bt):U(Ht,!1)})}e(mt);var Wt=d(mt);e(ot),e(kt),e(bt),e(ct),N((U,$)=>{O(K,"data-src",w(F).image_data),O(K,"alt",`User drawing ${w(F).id}`),X(At,w(F).likes||0),_t(ot,1,`cart-button ${U??""}`,"svelte-9n3om3"),X(Wt,` ${$??""}`)},[()=>c(w(F).id)?"in-cart":"",()=>c(w(F).id)?"Remove":"Add to Cart"],ht),m("click",K,()=>L()(w(F).image_data)),m("load",K,U=>{const $=U.target;$.dataset.src&&($.src=$.dataset.src)}),m("click",gt,()=>I()(w(F).id)),m("click",Pt,()=>L()(w(F).image_data)),m("click",Ct,()=>A()(w(F).image_data)),m("click",ot,()=>k(w(F))),l(tt,ct)}),e(J),l(f,J)};j(D,f=>{q().length===0?f(b):f(x,!1)},P)}};j(t,D=>{H()?D(p):D(h,!1)},r)}};j(y,t=>{B()?t(R):t(Z,!1)})}var W=d(y,2);{var V=t=>{var r=te(),p=s(r),h=s(p),D=d(h,2);e(p),e(r),N(()=>O(h,"src",z())),m("click",D,function(...P){var b;(b=i())==null||b.apply(this,P)}),m("click",p,Dt(function(P){xt.call(this,a,P)})),m("click",r,function(...P){var b;(b=i())==null||b.apply(this,P)}),l(t,r)};j(W,t=>{z()&&t(V)})}var Q=d(W,2);{var o=t=>{var r=ee(),p=s(r),h=s(p),D=s(h),P=s(D);lt(2),e(D),e(h);var b=d(h,2);e(p),e(r),N(()=>O(P,"src",E())),m("click",b,function(...x){var f;(f=C())==null||f.apply(this,x)}),m("click",p,Dt(function(x){xt.call(this,a,x)})),m("click",r,function(...x){var f;(f=C())==null||f.apply(this,x)}),l(t,r)};j(Q,t=>{E()&&t(o)})}e(_),l(G,_),rt(),v()}var se=u("<button></button>"),oe=u('<span class="svelte-1hgqvg2">…</span>'),ie=u("<!> <button> </button>",1),le=u('<nav class="pagination svelte-1hgqvg2"><button aria-label="Previous Page" class="svelte-1hgqvg2">◀ Prev</button> <!> <button aria-label="Next Page" class="svelte-1hgqvg2">Next ▶</button></nav>');function ne(G,a){at(a,!1);const g=Rt();let v=M(a,"currentPage",8,1),n=M(a,"totalPages",8,1);const q=jt(),I=i=>{i>=1&&i<=n()&&i!==v()&&q("pageChange",i)};Gt(()=>(yt(n()),yt(v())),()=>{qt(g,(()=>{if(n()<=7)return Array.from({length:n()},(C,S)=>S+1);const i=new Set;return i.add(1),i.add(n()),v()>1&&i.add(v()-1),i.add(v()),v()<n()&&i.add(v()+1),Array.from(i).sort((C,S)=>C-S)})())}),Zt(),st();var L=le(),A=s(L),B=d(A,2);{var H=i=>{var C=ut(),S=et(C);nt(S,1,()=>Array(n()),ft,(c,k,_)=>{var y=se();let R;y.textContent=_+1,N(Z=>R=_t(y,1,"svelte-1hgqvg2",null,R,Z),[()=>({selected:_+1===v()})],ht),m("click",y,()=>I(_+1)),l(c,y)}),l(i,C)},z=i=>{var C=ut(),S=et(C);nt(S,1,()=>w(g),ft,(c,k,_)=>{var y=ie(),R=et(y);{var Z=o=>{var t=oe();l(o,t)};j(R,o=>{_>0&&w(k)-w(g)[_-1]>1&&o(Z)})}var W=d(R,2);let V;var Q=s(W,!0);e(W),N(o=>{V=_t(W,1,"svelte-1hgqvg2",null,V,o),X(Q,w(k))},[()=>({selected:w(k)===v()})],ht),m("click",W,()=>I(w(k))),l(c,y)}),l(i,C)};j(B,i=>{n()<=7?i(H):i(z,!1)})}var E=d(B,2);e(L),N(()=>{A.disabled=v()===1,E.disabled=v()===n()}),m("click",A,()=>I(v()-1)),m("click",E,()=>I(v()+1)),l(G,L),rt()}var ve=u('<div class="gallery-controls svelte-19aqbvt"><!></div>');function ce(G,a){at(a,!1);let g=M(a,"currentPage",8),v=M(a,"totalPages",8),n=M(a,"onPageChange",8);st();var q=ut(),I=et(q);{var L=A=>{var B=ve(),H=s(B);ne(H,{get currentPage(){return g()},get totalPages(){return v()},$$events:{pageChange:z=>n()(z.detail)}}),e(B),l(A,B)};j(I,A=>{v()>1&&A(L)})}l(G,q),rt()}var de=u('<span class="cart-badge svelte-13mh0ai"> </span>'),ge=u('<div class="empty-cart svelte-13mh0ai"><p>Your cart is empty</p> <p class="empty-caption svelte-13mh0ai">Add drawings to create custom 3D objects</p></div>'),me=u('<div class="cart-item svelte-13mh0ai"><img alt="Drawing preview" class="cart-thumbnail svelte-13mh0ai"> <button class="remove-button svelte-13mh0ai"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M18 6L6 18M6 6l12 12"></path></svg></button></div>'),ue=u('<div class="cart-items svelte-13mh0ai"></div> <div class="cart-footer svelte-13mh0ai"><button class="clear-button svelte-13mh0ai">Clear All</button> <button class="checkout-button svelte-13mh0ai"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></button></div>',1),he=u('<div class="cart-panel svelte-13mh0ai"><div class="cart-header svelte-13mh0ai"><h3 class="svelte-13mh0ai"> </h3> <button class="close-button svelte-13mh0ai">×</button></div> <!></div>'),fe=u('<div class="cart-container svelte-13mh0ai"><button class="cart-button svelte-13mh0ai"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg> <!></button> <!></div>');function _e(G,a){at(a,!1);const[g,v]=pt(),n=()=>Y(Et,"$cartSize",g),q=()=>Y(Lt,"$cartStore",g);let I=M(a,"showCart",12,!1);function L(){I(!I())}function A(c){vt.removeFromCart(c)}function B(){I(!1),Nt("/gallery/checkout")}st();var H=fe(),z=s(H),E=d(s(z),2);{var i=c=>{var k=de(),_=s(k,!0);e(k),N(()=>X(_,n())),l(c,k)};j(E,c=>{n()>0&&c(i)})}e(z);var C=d(z,2);{var S=c=>{var k=he(),_=s(k),y=s(_),R=s(y);e(y);var Z=d(y,2);e(_);var W=d(_,2);{var V=o=>{var t=ge();l(o,t)},Q=o=>{var t=ue(),r=et(t);nt(r,5,q,ft,(b,x)=>{var f=me(),J=s(f),tt=d(J,2);e(f),N(()=>O(J,"src",w(x).imageData)),m("click",tt,()=>A(w(x).drawingId)),Mt(3,f,()=>Vt),l(b,f)}),e(r);var p=d(r,2),h=s(p),D=d(h,2),P=s(D);lt(),e(D),e(p),N(()=>X(P,`Checkout (${n()??""}) `)),m("click",h,function(...b){var x;(x=vt.clearCart)==null||x.apply(this,b)}),m("click",D,B),l(o,t)};j(W,o=>{n()===0?o(V):o(Q,!1)})}e(k),N(()=>X(R,`Your Cart (${n()??""})`)),m("click",Z,L),Mt(3,k,()=>Ut,()=>({y:-20,duration:200})),l(c,k)};j(C,c=>{I()&&c(S)})}e(H),m("click",z,L),l(G,H),rt(),v()}var pe=u('<div class="gallery-container svelte-np1y62"><!> <!> <!></div>');function be(G,a){at(a,!1);const[g,v]=pt(),n=()=>Y(_,"$pagination",g),q=()=>Y(it,"$likesStore",g),I=()=>Y(E,"$drawings",g),L=()=>Y(C,"$loading",g),A=()=>Y(i,"$error",g),B=()=>Y(S,"$selectedDrawing",g),H=()=>Y(c,"$selected3DDrawing",g),z=()=>Y(k,"$showCart",g),E=T([]),i=T(null),C=T(!1),S=T(null),c=T(null),k=T(!1),_=T({currentPage:1,totalPages:1,itemsPerPage:42});async function y(o){C.set(!0),i.set(null);const{currentPage:t,itemsPerPage:r}=n(),p=(o-1)*r;try{const{data:h,count:D,error:P}=await It.from("drawings").select("id, image_data, likes, created_at",{count:"exact"}).order("created_at",{ascending:!1}).range(p,p+r-1);if(P)throw P;E.set(h||[]),_.update(b=>({...b,currentPage:o,totalPages:Math.ceil((D||0)/r)})),it.update(b=>{const x={...b};return h==null||h.forEach(f=>x[f.id]=f.likes),x})}catch(h){i.set(h instanceof Error?h.message:"Failed to load drawings"),console.error("Gallery error:",h)}finally{C.set(!1)}}async function R(o){it.update(t=>{const r={...t};return r[o]=(r[o]||0)+1,r});try{await It.from("drawings").update({likes:q()[o]}).eq("id",o)}catch(t){console.error("Like update failed:",t),it.update(r=>{const p={...r};return p[o]=(p[o]||1)-1,p})}}y(1),st();var Z=pe(),W=s(Z);re(W,{get drawings(){return I()},get loading(){return L()},get error(){return A()},get selectedDrawing(){return B()},get selected3DDrawing(){return H()},onLike:R,onPreview:o=>S.set(o),on3DPreview:o=>c.set(o),onClosePreview:()=>S.set(null),onClose3DPreview:()=>c.set(null)});var V=d(W,2);ce(V,{get currentPage(){return n().currentPage},get totalPages(){return n().totalPages},onPageChange:y});var Q=d(V,2);_e(Q,{get showCart(){return z()}}),e(Z),l(G,Z),rt(),v()}var we=u('<meta name="description" content="Browse community creations">');function Re(G){Yt(a=>{var g=we();Ft.title="Gallery | Pexos",l(a,g)}),be(G,{})}export{Re as component};
