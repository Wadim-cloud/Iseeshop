import{c as J,a as r,t as y,d as Pe}from"../chunks/fM_HHR7z.js";import{i as we}from"../chunks/Dcs68N15.js";import{h as qe,c as Ae,p as ke,o as Ce,A as v,I as N,au as K,an as je,x as e,av as Oe,ap as L,a as xe,as as f,ar as g,at as n,aq as F,w as ge}from"../chunks/Cw_GAJ-8.js";import{s as Q,e as T,h as Re}from"../chunks/tsz7uQk5.js";import{i as U}from"../chunks/JX9NnDbc.js";import{p as ie}from"../chunks/DaUur2Kz.js";import{b as z,s as Ge,a as ue}from"../chunks/BbjLjIkL.js";import{s as re}from"../chunks/DTVZafTn.js";import{e as de,i as me}from"../chunks/C5uFXPOK.js";import{s as X}from"../chunks/5A2ZYZT-.js";import{s as pe}from"../chunks/B3wL8fD2.js";import{t as ne,a as he,s as Ne}from"../chunks/Dpaq57WD.js";import{s as _e}from"../chunks/Bfc47y5P.js";import{b as be}from"../chunks/DnUw-Gb1.js";import{g as oe,w as ye}from"../chunks/DV9TUGiz.js";import{p as $}from"../chunks/Ck0bcMIn.js";import{g as le}from"../chunks/E_7-NnNK.js";function Ue(M,l,o,P,R){var u;qe&&Ae();var w=(u=l.$$slots)==null?void 0:u[o],p=!1;w===!0&&(w=l.children,p=!0),w===void 0||w(M,p?()=>P:P)}var Be=y('<div class="nav-dot svelte-gh5nfs"><span class="dot-tooltip svelte-gh5nfs">Menu</span></div>'),De=y("<a> </a>"),Ee=y('<div class="mobile-overlay svelte-gh5nfs"><nav class="mobile-menu svelte-gh5nfs"><a href="/" class="brand svelte-gh5nfs"><img src="/logo192.png" alt="Pexos Logo" class="logo svelte-gh5nfs"> <span class="brand-name svelte-gh5nfs">Pexos</span></a> <div class="nav-links svelte-gh5nfs"></div> <div class="auth-section svelte-gh5nfs"><div class="user-profile svelte-gh5nfs"><img alt="User Avatar" class="avatar svelte-gh5nfs"> <span class="username svelte-gh5nfs"> </span></div> <button class="auth-button sign-out svelte-gh5nfs">Sign Out</button></div></nav></div>'),Ie=y("<a> </a>"),ze=y('<div class="user-profile svelte-gh5nfs"><img alt="User Avatar" class="avatar svelte-gh5nfs"> <span class="username svelte-gh5nfs"> </span></div> <button class="auth-button sign-out svelte-gh5nfs">Sign Out</button>',1),Me=y('<nav class="navbar svelte-gh5nfs"><div class="nav-container svelte-gh5nfs"><a href="/" class="brand svelte-gh5nfs"><img src="/logo192.png" alt="Pexos Logo" class="logo svelte-gh5nfs"> <span class="brand-name svelte-gh5nfs">Pexos</span></a> <div class="nav-links svelte-gh5nfs"></div> <div class="auth-section svelte-gh5nfs"><!></div></div></nav>');function He(M,l){ke(l,!1);const o=N(),P=N(),R=N(),w=N();let p=ie(l,"session",8),u=ie(l,"onAuthToggle",8);const B=[{name:"Todo",href:"/todo",authRequired:!0},{name:"Gallery",href:"/gallery",authRequired:!0},{name:"Create",href:"/create",authRequired:!0},{name:"About",href:"/about"}];let W=N(!1),d=N(!0),Y=N(!1);Ce(()=>{const t=()=>v(W,window.innerWidth<=768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)});const ee=()=>{v(d,!e(d))},ae=()=>{v(d,!0)},a=async()=>{v(Y,!0),v(d,!0),await le("/create")};K(()=>je(p()),()=>{var t;v(o,(t=p())==null?void 0:t.user)}),K(()=>e(o),()=>{var t,i;v(P,((i=(t=e(o))==null?void 0:t.user_metadata)==null?void 0:i.avatar_url)||"/default-avatar.png")}),K(()=>e(o),()=>{var t,i,G,q;v(R,((i=(t=e(o))==null?void 0:t.user_metadata)==null?void 0:i.full_name)||((q=(G=e(o))==null?void 0:G.email)==null?void 0:q.split("@")[0])||"User")}),K(()=>$,()=>{v(w,oe($).url.pathname==="/create")}),Oe(),we();var s=J(),k=L(s);{var H=t=>{var i=J(),G=L(i);{var q=A=>{var h=Be();T("click",h,ee),ne(1,h,()=>he),r(A,h)},Z=A=>{var h=Ee(),_=f(h),c=f(_),b=g(c,2);de(b,5,()=>B,me,(x,S)=>{var ce=J(),Se=L(ce);{var Te=te=>{var I=De();let ve;var Le=f(I,!0);n(I),F(se=>{X(I,"href",e(S).href),ve=pe(I,1,"nav-link svelte-gh5nfs",null,ve,se),Q(Le,e(S).name)},[()=>({active:oe($).url.pathname===e(S).href})],ge),T("click",I,function(...se){var fe;(fe=e(S).href==="/create"?a:()=>v(d,!0))==null||fe.apply(this,se)}),r(te,I)};U(Se,te=>{(!e(S).authRequired||e(S).authRequired&&p())&&te(Te)})}r(x,ce)}),n(b);var C=g(b,2),j=f(C),O=f(j),m=g(O,2),D=f(m,!0);n(m),n(j);var E=g(j,2);n(C),n(_),n(h),F(()=>{X(O,"src",e(P)),Q(D,e(R))}),T("click",c,()=>v(d,!0)),T("click",E,()=>{v(d,!0),u()()}),T("click",C,_e(function(x){be.call(this,l,x)})),ne(1,_,()=>Ne),T("click",_,_e(function(x){be.call(this,l,x)})),T("click",h,ae),r(A,h)};U(G,A=>{e(d)?A(q):A(Z,!1)})}r(t,i)},V=t=>{var i=Me(),G=f(i),q=g(f(G),2);de(q,5,()=>B,me,(_,c)=>{var b=J(),C=L(b);{var j=O=>{var m=Ie();let D;var E=f(m,!0);n(m),F(x=>{X(m,"href",e(c).href),D=pe(m,1,"nav-link svelte-gh5nfs",null,D,x),Q(E,e(c).name)},[()=>({active:oe($).url.pathname===e(c).href})],ge),T("click",m,function(...x){var S;(S=e(c).href==="/create"?a:void 0)==null||S.apply(this,x)}),r(O,m)};U(C,O=>{(!e(c).authRequired||e(c).authRequired&&p())&&O(j)})}r(_,b)}),n(q);var Z=g(q,2),A=f(Z);{var h=_=>{var c=ze(),b=L(c),C=f(b),j=g(C,2),O=f(j,!0);n(j),n(b);var m=g(b,2);F(()=>{X(C,"src",e(P)),Q(O,e(R))}),T("click",m,function(...D){var E;(E=u())==null||E.apply(this,D)}),r(_,c)};U(A,_=>{e(o)&&_(h)})}n(Z),n(G),n(i),ne(1,i,()=>he,()=>({duration:200})),r(t,i)};U(k,t=>{(e(W)||e(w)||e(Y))&&e(o)?t(H):t(V,!1)})}r(M,s),xe()}var Ve=Pe(`<script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TVHZWJGB');
    <\/script><!---->`,1),We=y('<meta name="google-site-verification" content="fP4cuGw4wrszN9kcVbzYHTB8bKj4YSxHTyZDSGOvyPk"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta property="og:title" content="Pexos, collaborative creative platform"> <meta property="og:description" content="Log in and start creating."> <meta property="og:image" content="https://pexos.netlify.app/logo192.png"> <meta property="og:url" content="https://pexos.netlify.app"> <meta property="og:type" content="website"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:title" content="Pexos, collaborative creative platform"> <meta name="twitter:description" content="Log in and start creating."> <meta name="twitter:image" content="https://pexos.netlify.app/logo192.png"> <!>',1),Ye=y("<div>Loading...</div>"),Ze=y("<!> <!>",1),Je=y("<noscript></noscript> <!>",1);function ga(M,l){ke(l,!1);const[o,P]=Ge(),R=()=>ue(u,"$sessionStore",o),w=()=>ue(B,"$loading",o);let p=ie(l,"data",8);const u=ye(p().session),B=ye(!0);re.auth.getSession().then(async({data:{session:a},error:s})=>{console.log("Client session loaded at:",new Date().toISOString()),s&&console.error("Session load error:",s.message),z(u,a||p().session),z(B,!1)}).catch(a=>{console.error("Session load error:",a),z(u,null),z(B,!1)}),re.auth.onAuthStateChange((a,s)=>{var k;console.log("Layout auth state changed:",a,(k=s==null?void 0:s.user)==null?void 0:k.email),z(u,s),a==="SIGNED_OUT"&&(console.log("User signed out, redirecting to /"),le("/",{replaceState:!0}))});async function W(){if(R()){console.log("Initiating sign out");try{const{error:a}=await re.auth.signOut();if(a)throw console.error("Sign out error:",a.message),a;console.log("Signed out successfully"),z(u,null),le("/",{replaceState:!0})}catch(a){console.error("Sign out failed:",a)}}}we();var d=Je();Re(a=>{var s=We(),k=g(L(s),22);{var H=V=>{var t=Ve();g(L(t)),r(V,t)};U(k,V=>{V(H)})}r(a,s)});var Y=g(L(d),2);{var ee=a=>{var s=Ye();r(a,s)},ae=a=>{var s=Ze(),k=L(s);He(k,{get session(){return R()},onAuthToggle:W});var H=g(k,2);Ue(H,l,"default",{}),r(a,s)};U(Y,a=>{w()?a(ee):a(ae,!1)})}r(M,d),xe(),P()}export{ga as component};
