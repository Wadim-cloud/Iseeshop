import{t as u,a as l,n as Mt,c as at}from"../chunks/fM_HHR7z.js";import{i as rt}from"../chunks/Dcs68N15.js";import{p as st,a as ot,ar as m,as as i,at as a,aq as N,aP as nt,x as h,w as ht,ax as jt,ap as tt,aw as Ht}from"../chunks/Cw_GAJ-8.js";import{e as d,s as $,h as Gt}from"../chunks/tsz7uQk5.js";import{g as Rt}from"../chunks/BsK15QRw.js";import{s as _t,a as Y}from"../chunks/BbjLjIkL.js";import{i as B}from"../chunks/JX9NnDbc.js";import{e as vt,i as It}from"../chunks/C5uFXPOK.js";import{s as O}from"../chunks/5A2ZYZT-.js";import{s as ft}from"../chunks/B3wL8fD2.js";import{s as Ct}from"../chunks/Bfc47y5P.js";import{b as yt}from"../chunks/DnUw-Gb1.js";import{p as C}from"../chunks/DaUur2Kz.js";import{a as ct,c as Lt,b as Zt,l as lt}from"../chunks/BYbTja4Y.js";import{t as Dt,f as Ft,s as Yt}from"../chunks/Dpaq57WD.js";import{s as xt}from"../chunks/CI_hdHvm.js";import{w as X}from"../chunks/DV9TUGiz.js";var Nt=u('<div class="loading svelte-9n3om3">Loading gallery...</div>'),Et=u('<div class="error svelte-9n3om3"> </div>'),Ut=u('<div class="no-content svelte-9n3om3">No drawings available.</div>'),Vt=Mt('<path d="M9 20a1 1 0 100-2 1 1 0 000 2z" fill="#4CAF50"></path><path d="M20 20a1 1 0 100-2 1 1 0 000 2z" fill="#4CAF50"></path><path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6" stroke="#4CAF50"></path>'),qt=Mt('<path d="M9 20a1 1 0 100-2 1 1 0 000 2z"></path><path d="M20 20a1 1 0 100-2 1 1 0 000 2z"></path><path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"></path>'),Jt=u('<div class="gallery-item svelte-9n3om3"><img class="gallery-image svelte-9n3om3" loading="lazy"> <div class="gallery-meta svelte-9n3om3"><div class="gallery-stats svelte-9n3om3"><button class="like-button svelte-9n3om3"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333" class="svelte-9n3om3"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg> <span> </span></button></div> <div class="button-group svelte-9n3om3"><button class="preview-button svelte-9n3om3"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg> Preview</button> <button class="preview-button preview-3d svelte-9n3om3"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path><path d="M12 18a6 6 0 100-12 6 6 0 000 12z"></path><path d="M12 14a2 2 0 100-4 2 2 0 000 4z"></path></svg> 3D View</button> <button><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333"><!></svg> </button></div></div></div>'),Qt=u('<div class="gallery-grid svelte-9n3om3"></div>'),Tt=u('<div class="modal svelte-9n3om3"><div class="modal-content svelte-9n3om3"><img alt="Drawing preview" class="svelte-9n3om3"> <button class="close-button svelte-9n3om3">×</button></div></div>'),Xt=u('<div class="modal svelte-9n3om3"><div class="modal-content modal-3d svelte-9n3om3"><div class="preview-3d-container svelte-9n3om3"><div class="preview-3d-placeholder svelte-9n3om3"><img alt="3D preview" class="preview-texture svelte-9n3om3"> <div class="preview-3d-object svelte-9n3om3"><span>3D Preview</span></div></div></div> <button class="close-button svelte-9n3om3">×</button></div></div>'),$t=u('<div class="gallery-wrapper svelte-9n3om3"><!> <!> <!></div>');function Kt(G,s){st(s,!1);const[r,y]=_t(),D=()=>Y(Lt,"$cartStore",r);let x=C(s,"drawings",8),M=C(s,"onLike",8),z=C(s,"onPreview",8),W=C(s,"on3DPreview",8),R=C(s,"loading",8),j=C(s,"error",8),I=C(s,"selectedDrawing",8),f=C(s,"selected3DDrawing",8),L=C(s,"onClosePreview",8),H=C(s,"onClose3DPreview",8);const A="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjgiIGZpbGw9IiNjY2MiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPkxvYWRpbmc8L3RleHQ+PC9zdmc+";function n(t){return D().some(e=>e.drawingId===t)}function _(t){n(t.id)?ct.removeFromCart(t.id):ct.addToCart(t)}rt();var p=$t(),S=i(p);{var Z=t=>{var e=Nt();l(t,e)},E=(t,e)=>{{var c=P=>{var w=Et(),b=i(w,!0);a(w),N(()=>$(b,j())),l(P,w)},v=(P,w)=>{{var b=g=>{var Q=Ut();l(g,Q)},k=g=>{var Q=Qt();vt(Q,5,x,et=>et.id,(et,F)=>{var dt=Jt(),K=i(dt);O(K,"src",A);var pt=m(K,2),mt=i(pt),ut=i(mt),bt=m(i(ut),2),St=i(bt,!0);a(bt),a(ut),a(mt);var wt=m(mt,2),Pt=i(wt),kt=m(Pt,2),it=m(kt,2),gt=i(it),zt=i(gt);{var At=U=>{var q=Vt();nt(2),l(U,q)},Bt=U=>{var q=qt();nt(2),l(U,q)};B(zt,U=>{n(h(F).id)?U(At):U(Bt,!1)})}a(gt);var Wt=m(gt);a(it),a(wt),a(pt),a(dt),N((U,q)=>{O(K,"data-src",h(F).image_data),O(K,"alt",`User drawing ${h(F).id}`),$(St,h(F).likes||0),ft(it,1,`cart-button ${U??""}`,"svelte-9n3om3"),$(Wt,` ${q??""}`)},[()=>n(h(F).id)?"in-cart":"",()=>n(h(F).id)?"Remove":"Add to Cart"],ht),d("click",K,()=>z()(h(F).image_data)),d("load",K,U=>{const q=U.target;q.dataset.src&&(q.src=q.dataset.src)}),d("click",ut,()=>M()(h(F).id)),d("click",Pt,()=>z()(h(F).image_data)),d("click",kt,()=>W()(h(F).image_data)),d("click",it,()=>_(h(F))),l(et,dt)}),a(Q),l(g,Q)};B(P,g=>{x().length===0?g(b):g(k,!1)},w)}};B(t,P=>{j()?P(c):P(v,!1)},e)}};B(S,t=>{R()?t(Z):t(E,!1)})}var V=m(S,2);{var J=t=>{var e=Tt(),c=i(e),v=i(c),P=m(v,2);a(c),a(e),N(()=>O(v,"src",I())),d("click",P,function(...w){var b;(b=L())==null||b.apply(this,w)}),d("click",c,Ct(function(w){yt.call(this,s,w)})),d("click",e,function(...w){var b;(b=L())==null||b.apply(this,w)}),l(t,e)};B(V,t=>{I()&&t(J)})}var T=m(V,2);{var o=t=>{var e=Xt(),c=i(e),v=i(c),P=i(v),w=i(P);nt(2),a(P),a(v);var b=m(v,2);a(c),a(e),N(()=>O(w,"src",f())),d("click",b,function(...k){var g;(g=H())==null||g.apply(this,k)}),d("click",c,Ct(function(k){yt.call(this,s,k)})),d("click",e,function(...k){var g;(g=H())==null||g.apply(this,k)}),l(t,e)};B(T,t=>{f()&&t(o)})}a(p),l(G,p),ot(),y()}var Ot=u("<button></button>"),te=u("<button> </button>"),ee=u('<span class="svelte-rc3ooi">…</span>'),ae=u('<nav class="pagination svelte-rc3ooi"><button aria-label="Previous Page" class="svelte-rc3ooi">◀ Prev</button> <!> <button aria-label="Next Page" class="svelte-rc3ooi">Next ▶</button></nav>');function re(G,s){st(s,!1);let r=C(s,"currentPage",8,1),y=C(s,"totalPages",8,1);const D=jt(),x=f=>{f>=1&&f<=y()&&f!==r()&&D("pageChange",f)};rt();var M=ae(),z=i(M),W=m(z,2);{var R=f=>{var L=at(),H=tt(L);vt(H,1,()=>Array(y()),It,(A,n,_)=>{var p=Ot();let S;p.textContent=_+1,N(Z=>S=ft(p,1,"svelte-rc3ooi",null,S,Z),[()=>({selected:_+1===r()})],ht),d("click",p,()=>x(_+1)),l(A,p)}),l(f,L)},j=f=>{var L=at(),H=tt(L);vt(H,1,()=>[1,r()-1,r(),r()+1,y()],A=>A,(A,n)=>{var _=at(),p=tt(_);{var S=Z=>{var E=at(),V=tt(E);{var J=o=>{var t=te();let e;var c=i(t,!0);a(t),N(v=>{e=ft(t,1,"svelte-rc3ooi",null,e,v),$(c,h(n))},[()=>({selected:h(n)===r()})],ht),d("click",t,()=>x(h(n))),l(o,t)},T=o=>{var t=ee();l(o,t)};B(V,o=>{h(n)!==r()-2&&h(n)!==r()+2?o(J):o(T,!1)})}l(Z,E)};B(p,Z=>{h(n)>0&&h(n)<=y()&&Z(S)})}l(A,_)}),l(f,L)};B(W,f=>{y()<=7?f(R):f(j,!1)})}var I=m(W,2);a(M),N(()=>{z.disabled=r()===1,I.disabled=r()===y()}),d("click",z,()=>x(r()-1)),d("click",I,()=>x(r()+1)),l(G,M),ot()}var se=u('<div class="gallery-controls svelte-19aqbvt"><!></div>');function oe(G,s){st(s,!1);let r=C(s,"currentPage",8),y=C(s,"totalPages",8),D=C(s,"onPageChange",8);rt();var x=at(),M=tt(x);{var z=W=>{var R=se(),j=i(R);re(j,{get currentPage(){return r()},get totalPages(){return y()},$$events:{pageChange:I=>D()(I.detail)}}),a(R),l(W,R)};B(M,W=>{y()>1&&W(z)})}l(G,x),ot()}var ie=u('<span class="cart-badge svelte-13mh0ai"> </span>'),le=u('<div class="empty-cart svelte-13mh0ai"><p>Your cart is empty</p> <p class="empty-caption svelte-13mh0ai">Add drawings to create custom 3D objects</p></div>'),ne=u('<div class="cart-item svelte-13mh0ai"><img alt="Drawing preview" class="cart-thumbnail svelte-13mh0ai"> <button class="remove-button svelte-13mh0ai"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M18 6L6 18M6 6l12 12"></path></svg></button></div>'),ve=u('<div class="cart-items svelte-13mh0ai"></div> <div class="cart-footer svelte-13mh0ai"><button class="clear-button svelte-13mh0ai">Clear All</button> <button class="checkout-button svelte-13mh0ai"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></button></div>',1),ce=u('<div class="cart-panel svelte-13mh0ai"><div class="cart-header svelte-13mh0ai"><h3 class="svelte-13mh0ai"> </h3> <button class="close-button svelte-13mh0ai">×</button></div> <!></div>'),de=u('<div class="cart-container svelte-13mh0ai"><button class="cart-button svelte-13mh0ai"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg> <!></button> <!></div>');function me(G,s){st(s,!1);const[r,y]=_t(),D=()=>Y(Zt,"$cartSize",r),x=()=>Y(Lt,"$cartStore",r);let M=C(s,"showCart",12,!1);function z(){M(!M())}function W(n){ct.removeFromCart(n)}function R(){M(!1),Rt("/gallery/checkout")}rt();var j=de(),I=i(j),f=m(i(I),2);{var L=n=>{var _=ie(),p=i(_,!0);a(_),N(()=>$(p,D())),l(n,_)};B(f,n=>{D()>0&&n(L)})}a(I);var H=m(I,2);{var A=n=>{var _=ce(),p=i(_),S=i(p),Z=i(S);a(S);var E=m(S,2);a(p);var V=m(p,2);{var J=o=>{var t=le();l(o,t)},T=o=>{var t=ve(),e=tt(t);vt(e,5,x,It,(b,k)=>{var g=ne(),Q=i(g),et=m(Q,2);a(g),N(()=>O(Q,"src",h(k).imageData)),d("click",et,()=>W(h(k).drawingId)),Dt(3,g,()=>Yt),l(b,g)}),a(e);var c=m(e,2),v=i(c),P=m(v,2),w=i(P);nt(),a(P),a(c),N(()=>$(w,`Checkout (${D()??""}) `)),d("click",v,function(...b){var k;(k=ct.clearCart)==null||k.apply(this,b)}),d("click",P,R),l(o,t)};B(V,o=>{D()===0?o(J):o(T,!1)})}a(_),N(()=>$(Z,`Your Cart (${D()??""})`)),d("click",E,z),Dt(3,_,()=>Ft,()=>({y:-20,duration:200})),l(n,_)};B(H,n=>{M()&&n(A)})}a(j),d("click",I,z),l(G,j),ot(),y()}var ue=u('<div class="gallery-container svelte-np1y62"><!> <!> <!></div>');function ge(G,s){st(s,!1);const[r,y]=_t(),D=()=>Y(p,"$pagination",r),x=()=>Y(lt,"$likesStore",r),M=()=>Y(f,"$drawings",r),z=()=>Y(H,"$loading",r),W=()=>Y(L,"$error",r),R=()=>Y(A,"$selectedDrawing",r),j=()=>Y(n,"$selected3DDrawing",r),I=()=>Y(_,"$showCart",r),f=X([]),L=X(null),H=X(!1),A=X(null),n=X(null),_=X(!1),p=X({currentPage:1,totalPages:1,itemsPerPage:40});async function S(o){H.set(!0),L.set(null);const{currentPage:t,itemsPerPage:e}=D(),c=(o-1)*e;try{const{data:v,count:P,error:w}=await xt.from("drawings").select("id, image_data, likes, created_at",{count:"exact"}).order("created_at",{ascending:!1}).range(c,c+e-1);if(w)throw w;f.set(v||[]),p.update(b=>({...b,currentPage:o,totalPages:Math.ceil((P||0)/e)})),lt.update(b=>{const k={...b};return v==null||v.forEach(g=>k[g.id]=g.likes),k})}catch(v){L.set(v instanceof Error?v.message:"Failed to load drawings"),console.error("Gallery error:",v)}finally{H.set(!1)}}async function Z(o){lt.update(t=>{const e={...t};return e[o]=(e[o]||0)+1,e});try{await xt.from("drawings").update({likes:x()[o]}).eq("id",o)}catch(t){console.error("Like update failed:",t),lt.update(e=>{const c={...e};return c[o]=(c[o]||1)-1,c})}}S(1),rt();var E=ue(),V=i(E);Kt(V,{get drawings(){return M()},get loading(){return z()},get error(){return W()},get selectedDrawing(){return R()},get selected3DDrawing(){return j()},onLike:Z,onPreview:o=>A.set(o),on3DPreview:o=>n.set(o),onClosePreview:()=>A.set(null),onClose3DPreview:()=>n.set(null)});var J=m(V,2);oe(J,{get currentPage(){return D().currentPage},get totalPages(){return D().totalPages},onPageChange:S});var T=m(J,2);me(T,{get showCart(){return I()}}),a(E),l(G,E),ot(),y()}var he=u('<meta name="description" content="Browse community creations">');function Be(G){Gt(s=>{var r=he();Ht.title="Gallery | Pexos",l(s,r)}),ge(G,{})}export{Be as component};
