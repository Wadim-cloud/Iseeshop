import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Ye,o as je,an as $,ao as I,x as t,a as Ae,ar as m,ap as c,G as y,A as i,aB as We,as as g}from"../chunks/9BOlcS-b.js";import{e as D,s as B}from"../chunks/BsZz1DC-.js";import{i as U}from"../chunks/WEOj8Vpi.js";import{e as fe,i as we}from"../chunks/DhNq3B23.js";import{t as h,a as f,c as qe}from"../chunks/Bnw62dMu.js";import{r as he,s as ze}from"../chunks/CTf98LKf.js";import{b as pe}from"../chunks/9x1-h8O0.js";import{b as Ge}from"../chunks/BaLMMi1F.js";import{b as He}from"../chunks/trMeve9e.js";import{i as Je}from"../chunks/xvq0-Hdq.js";import{s as F}from"../chunks/BeMxMaC5.js";const v=[];for(let a=0;a<256;++a)v.push((a+256).toString(16).slice(1));function Ke(a,s=0){return(v[a[s+0]]+v[a[s+1]]+v[a[s+2]]+v[a[s+3]]+"-"+v[a[s+4]]+v[a[s+5]]+"-"+v[a[s+6]]+v[a[s+7]]+"-"+v[a[s+8]]+v[a[s+9]]+"-"+v[a[s+10]]+v[a[s+11]]+v[a[s+12]]+v[a[s+13]]+v[a[s+14]]+v[a[s+15]]).toLowerCase()}let ee;const Oe=new Uint8Array(16);function Qe(){if(!ee){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ee=crypto.getRandomValues.bind(crypto)}return ee(Oe)}const Ze=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_e={randomUUID:Ze};function $e(a,s,n){var p;if(_e.randomUUID&&!a)return _e.randomUUID();a=a||{};const l=a.random??((p=a.rng)==null?void 0:p.call(a))??Qe();if(l.length<16)throw new Error("Random bytes length must be >= 16");return l[6]=l[6]&15|64,l[8]=l[8]&63|128,Ke(l)}var et=h("<option> </option>"),tt=h('<p class="error svelte-hwv8gf"> </p>'),at=h("<p>Loading drawings...</p>"),rt=h("<p>No drawings found.</p>"),nt=h('<img alt="Preview" class="drawing-preview svelte-hwv8gf">'),ot=h('<div class="drawing-preview svelte-hwv8gf" style="display: flex; align-items: center; justify-content: center; background: #eee;">No Image</div>'),it=h("<span> </span>"),st=h('<div class="drawing-item svelte-hwv8gf"><!> <div class="drawing-info svelte-hwv8gf"><strong> </strong> <!></div></div>'),lt=h('<div class="modal-overlay svelte-hwv8gf"></div> <div class="modal svelte-hwv8gf"><h2>Select a Drawing</h2> <div class="modal-content svelte-hwv8gf"><!></div> <div class="modal-buttons svelte-hwv8gf"><button class="svelte-hwv8gf">Close</button></div></div>',1),vt=h('<div class="container svelte-hwv8gf"><div class="controls svelte-hwv8gf"><input type="text" placeholder="Enter Drawing ID" class="svelte-hwv8gf"> <button class="svelte-hwv8gf">Choose Drawing</button> <button class="svelte-hwv8gf">Reset</button> <button class="svelte-hwv8gf">Save Drawing</button> <select class="svelte-hwv8gf"></select> <input type="range" min="1" max="50" class="svelte-hwv8gf"> <button class="svelte-hwv8gf">Clear Canvas</button></div> <!> <canvas width="800" height="600" class="svelte-hwv8gf"></canvas></div> <!>',1);function xt(a,s){Ye(s,!1);let n=y(),l,p=y(""),R=y("black"),P=y(5),X=!1,Y=0,j=0,_=y(""),C=y(!1),A=y([]),S=y(!1);const be=["black","red","blue","green"];je(()=>(l=t(n).getContext("2d"),l.lineJoin="round",l.lineCap="round",t(n).addEventListener("mousedown",W),t(n).addEventListener("mousemove",q),t(n).addEventListener("mouseup",x),t(n).addEventListener("mouseout",x),t(n).addEventListener("touchstart",re),t(n).addEventListener("touchmove",ne),t(n).addEventListener("touchend",x),te(),()=>{t(n).removeEventListener("mousedown",W),t(n).removeEventListener("mousemove",q),t(n).removeEventListener("mouseup",x),t(n).removeEventListener("mouseout",x),t(n).removeEventListener("touchstart",re),t(n).removeEventListener("touchmove",ne),t(n).removeEventListener("touchend",x)}));async function te(){try{i(S,!0);const{data:e,error:r}=await F.from("drawings").select("drawing_id, title, image_data").limit(5).order("created_at",{ascending:!1});if(r)throw r;i(A,e||[]),i(S,!1)}catch(e){console.error("Error preloading drawings:",e),i(_,"Failed to load drawings"),i(S,!1)}}function W(e){X=!0,[Y,j]=ae(e)}function q(e){if(!X)return;e.preventDefault();const[r,o]=ae(e);l.beginPath(),l.moveTo(Y,j),l.lineTo(r,o),l.strokeStyle=t(R),l.lineWidth=t(P),l.stroke(),[Y,j]=[r,o]}function x(){X=!1}function ae(e){const r=t(n).getBoundingClientRect();let o,u;return e.type.startsWith("touch")?(o=e.touches[0].clientX-r.left,u=e.touches[0].clientY-r.top):(o=e.clientX-r.left,u=e.clientY-r.top),[o,u]}function re(e){e.preventDefault(),W(e)}function ne(e){e.preventDefault(),q(e)}async function oe(){if(!t(p).trim()){i(_,"Please enter a Drawing ID");return}try{const{data:e,error:r}=await F.from("drawings").select("image_data").eq("drawing_id",t(p)).single();if(r)throw r;if(e&&e.image_data){const o=new Image;o.onload=()=>{l.clearRect(0,0,t(n).width,t(n).height),l.drawImage(o,0,0,t(n).width,t(n).height)},o.src=e.image_data,i(_,"")}else i(_,"No background image found for this drawing"),ie()}catch(e){console.error("Error loading background:",e),i(_,"Failed to load drawing")}}async function ye(){var o,u;const e=t(n).toDataURL("image/png"),r=$e();try{const{data:d}=await F.auth.getUser(),K=((o=d==null?void 0:d.user)==null?void 0:o.id)||"user-uuid-placeholder",O=((u=d==null?void 0:d.user)==null?void 0:u.email)||"user@example.com",{error:T}=await F.from("drawings").insert({drawing_id:r,image_data:e,title:"New Drawing",user_id:K,user_email:O});if(T)throw T;i(_,""),alert("Drawing saved successfully with ID: "+r),i(p,r),await te()}catch(d){console.error("Error saving drawing:",d),i(_,"Failed to save drawing: "+d.message)}}function ie(){l.clearRect(0,0,t(n).width,t(n).height)}function De(e){i(p,e),i(C,!1),oe()}function xe(){i(C,!0)}Je();var se=vt(),z=$(se),G=m(z),H=m(G);he(H);var le=c(H,2),ve=c(le,2),de=c(ve,2),M=c(de,2);I(()=>{t(R),We(()=>{})}),fe(M,5,()=>be,we,(e,r)=>{var o=et(),u={},d=m(o,!0);g(o),I(()=>{u!==(u=t(r))&&(o.value=(o.__value=t(r))??""),B(d,t(r))}),f(e,o)}),g(M);var J=c(M,2);he(J);var Ee=c(J,2);g(G);var ce=c(G,2);{var Le=e=>{var r=tt(),o=m(r,!0);g(r),I(()=>B(o,t(_))),f(e,r)};U(ce,e=>{t(_)&&e(Le)})}var ke=c(ce,2);He(ke,e=>i(n,e),()=>t(n)),g(z);var Ie=c(z,2);{var Ue=e=>{var r=lt(),o=$(r),u=c(o,2),d=c(m(u),2),K=m(d);{var O=E=>{var Q=at();f(E,Q)},T=(E,Q)=>{{var Re=L=>{var N=rt();f(L,N)},Se=L=>{var N=qe(),Me=$(N);fe(Me,1,()=>t(A),we,(Te,k)=>{var V=st(),ge=m(V);{var Ne=w=>{var b=nt();I(()=>ze(b,"src",t(k).image_data)),f(w,b)},Ve=w=>{var b=ot();f(w,b)};U(ge,w=>{t(k).image_data?w(Ne):w(Ve,!1)})}var me=c(ge,2),Z=m(me),Be=m(Z,!0);g(Z);var Fe=c(Z,2);{var Pe=w=>{var b=it(),Xe=m(b);g(b),I(()=>B(Xe,`- ${t(k).title??""}`)),f(w,b)};U(Fe,w=>{t(k).title&&w(Pe)})}g(me),g(V),I(()=>B(Be,t(k).drawing_id)),D("click",V,()=>De(t(k).drawing_id)),f(Te,V)}),f(L,N)};U(E,L=>{t(A).length===0?L(Re):L(Se,!1)},Q)}};U(K,E=>{t(S)?E(O):E(T,!1)})}g(d);var ue=c(d,2),Ce=m(ue);g(ue),g(u),D("click",o,()=>i(C,!1)),D("click",Ce,()=>i(C,!1)),f(e,r)};U(Ie,e=>{t(C)&&e(Ue)})}pe(H,()=>t(p),e=>i(p,e)),D("click",le,xe),D("click",ve,oe),D("click",de,ye),Ge(M,()=>t(R),e=>i(R,e)),pe(J,()=>t(P),e=>i(P,e)),D("click",Ee,ie),f(a,se),Ae()}export{xt as component};
