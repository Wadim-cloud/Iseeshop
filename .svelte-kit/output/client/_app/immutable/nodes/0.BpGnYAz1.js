import{c as J,a as o,t as x,e as Ce}from"../chunks/DPmhzSt5.js";import{i as we}from"../chunks/CHpTJ84V.js";import{h as Le,c as je,C as Ae,p as ke,o as Oe,a1 as u,A as G,aC as K,av as qe,t as e,aD as Re,ax as j,a as xe,Y as f,az as g,Z as l,ay as F,v as fe}from"../chunks/BDHGhfTE.js";import{e as L,d as ze}from"../chunks/CvTsB6m-.js";import{i as N}from"../chunks/1K336M6a.js";import{p as le,c as I,a as De,b as ge}from"../chunks/ChMpMzq7.js";import{s as re}from"../chunks/BqOODIDs.js";import{s as Q}from"../chunks/CTjs_13Y.js";import{e as de,i as pe}from"../chunks/CgxHyAce.js";import{a as X}from"../chunks/D02H29ki.js";import{s as me}from"../chunks/5ddwAlOI.js";import{t as ne,f as he,s as Ge}from"../chunks/CNoJYvQC.js";import{g as oe,w as _e}from"../chunks/DH2AK175.js";import{p as $}from"../chunks/CsGhAA03.js";import{g as ie}from"../chunks/BimYdWYP.js";function Ne(d,r,s,_,S){var p;Le&&je();var c=(p=r.$$slots)==null?void 0:p[s],y=!1;c===!0&&(c=r.children,y=!0),c===void 0||c(d,y?()=>_:_)}function ye(d){return function(...r){var s=r[0];return s.stopPropagation(),d==null?void 0:d.apply(this,r)}}function be(d,r){var c;var s=(c=d.$$events)==null?void 0:c[r.type],_=Ae(s)?s.slice():s==null?[]:[s];for(var S of _)S.call(this,r)}const Ue=!0,fa=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ue},Symbol.toStringTag,{value:"Module"}));var Ee=x('<div class="nav-dot svelte-gh5nfs"><span class="dot-tooltip svelte-gh5nfs">Menu</span></div>'),Me=x("<a> </a>"),Be=x('<div class="mobile-overlay svelte-gh5nfs"><nav class="mobile-menu svelte-gh5nfs"><a href="/" class="brand svelte-gh5nfs"><img src="/logo192.png" alt="Pexos Logo" class="logo svelte-gh5nfs"> <span class="brand-name svelte-gh5nfs">Pexos</span></a> <div class="nav-links svelte-gh5nfs"></div> <div class="auth-section svelte-gh5nfs"><div class="user-profile svelte-gh5nfs"><img alt="User Avatar" class="avatar svelte-gh5nfs"> <span class="username svelte-gh5nfs"> </span></div> <button class="auth-button sign-out svelte-gh5nfs">Sign Out</button></div></nav></div>'),Ie=x("<a> </a>"),He=x('<div class="user-profile svelte-gh5nfs"><img alt="User Avatar" class="avatar svelte-gh5nfs"> <span class="username svelte-gh5nfs"> </span></div> <button class="auth-button sign-out svelte-gh5nfs">Sign Out</button>',1),Ye=x('<nav class="navbar svelte-gh5nfs"><div class="nav-container svelte-gh5nfs"><a href="/" class="brand svelte-gh5nfs"><img src="/logo192.png" alt="Pexos Logo" class="logo svelte-gh5nfs"> <span class="brand-name svelte-gh5nfs">Pexos</span></a> <div class="nav-links svelte-gh5nfs"></div> <div class="auth-section svelte-gh5nfs"><!></div></div></nav>');function Ze(d,r){ke(r,!1);const s=G(),_=G(),S=G(),c=G();let y=le(r,"session",8),p=le(r,"onAuthToggle",8);const U=[{name:"Todo",href:"/todo",authRequired:!0},{name:"Gallery",href:"/gallery",authRequired:!0},{name:"Create",href:"/create",authRequired:!0},{name:"About",href:"/about"}];let Z=G(!1),m=G(!0),V=G(!1);Oe(()=>{const t=()=>u(Z,window.innerWidth<=768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)});const ee=()=>{u(m,!e(m))},ae=()=>{u(m,!0)},a=async()=>{u(V,!0),u(m,!0),await ie("/create")};K(()=>qe(y()),()=>{var t;u(s,(t=y())==null?void 0:t.user)}),K(()=>e(s),()=>{var t,i;u(_,((i=(t=e(s))==null?void 0:t.user_metadata)==null?void 0:i.avatar_url)||"/default-avatar.png")}),K(()=>e(s),()=>{var t,i,D,A;u(S,((i=(t=e(s))==null?void 0:t.user_metadata)==null?void 0:i.full_name)||((A=(D=e(s))==null?void 0:D.email)==null?void 0:A.split("@")[0])||"User")}),K(()=>$,()=>{u(c,oe($).url.pathname==="/create")}),Re(),we();var n=J(),T=j(n);{var H=t=>{var i=J(),D=j(i);{var A=O=>{var b=Ee();L("click",b,ee),ne(1,b,()=>he),o(O,b)},W=O=>{var b=Be(),w=f(b),v=f(w),k=g(v,2);de(k,5,()=>U,pe,(P,C)=>{var ce=J(),Se=j(ce);{var Te=te=>{var B=Me();let ve;var Pe=f(B,!0);l(B),F(se=>{X(B,"href",e(C).href),ve=me(B,1,"nav-link svelte-gh5nfs",null,ve,se),Q(Pe,e(C).name)},[()=>({active:oe($).url.pathname===e(C).href})],fe),L("click",B,function(...se){var ue;(ue=e(C).href==="/create"?a:()=>u(m,!0))==null||ue.apply(this,se)}),o(te,B)};N(Se,te=>{(!e(C).authRequired||e(C).authRequired&&y())&&te(Te)})}o(P,ce)}),l(k);var q=g(k,2),R=f(q),z=f(R),h=g(z,2),E=f(h,!0);l(h),l(R);var M=g(R,2);l(q),l(w),l(b),F(()=>{X(z,"src",e(_)),Q(E,e(S))}),L("click",v,()=>u(m,!0)),L("click",M,()=>{u(m,!0),p()()}),L("click",q,ye(function(P){be.call(this,r,P)})),ne(1,w,()=>Ge),L("click",w,ye(function(P){be.call(this,r,P)})),L("click",b,ae),o(O,b)};N(D,O=>{e(m)?O(A):O(W,!1)})}o(t,i)},Y=t=>{var i=Ye(),D=f(i),A=g(f(D),2);de(A,5,()=>U,pe,(w,v)=>{var k=J(),q=j(k);{var R=z=>{var h=Ie();let E;var M=f(h,!0);l(h),F(P=>{X(h,"href",e(v).href),E=me(h,1,"nav-link svelte-gh5nfs",null,E,P),Q(M,e(v).name)},[()=>({active:oe($).url.pathname===e(v).href})],fe),L("click",h,function(...P){var C;(C=e(v).href==="/create"?a:void 0)==null||C.apply(this,P)}),o(z,h)};N(q,z=>{(!e(v).authRequired||e(v).authRequired&&y())&&z(R)})}o(w,k)}),l(A);var W=g(A,2),O=f(W);{var b=w=>{var v=He(),k=j(v),q=f(k),R=g(q,2),z=f(R,!0);l(R),l(k);var h=g(k,2);F(()=>{X(q,"src",e(_)),Q(z,e(S))}),L("click",h,function(...E){var M;(M=p())==null||M.apply(this,E)}),o(w,v)};N(O,w=>{e(s)&&w(b)})}l(W),l(D),l(i),ne(1,i,()=>he,()=>({duration:200})),o(t,i)};N(T,t=>{(e(Z)||e(c)||e(V))&&e(s)?t(H):t(Y,!1)})}o(d,n),xe()}var Ve=Ce(`<script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TVHZWJGB');
    <\/script><!---->`,1),We=x('<meta name="google-site-verification" content="fP4cuGw4wrszN9kcVbzYHTB8bKj4YSxHTyZDSGOvyPk"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta property="og:title" content="Pexos, collaborative creative platform"> <meta property="og:description" content="Log in and start creating."> <meta property="og:image" content="https://pexos.netlify.app/logo192.png"> <meta property="og:url" content="https://pexos.netlify.app"> <meta property="og:type" content="website"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:title" content="Pexos, collaborative creative platform"> <meta name="twitter:description" content="Log in and start creating."> <meta name="twitter:image" content="https://pexos.netlify.app/logo192.png"> <!>',1),Je=x("<div>Loading...</div>"),Ke=x("<!> <!>",1),Fe=x("<noscript></noscript> <!>",1);function ga(d,r){ke(r,!1);const[s,_]=De(),S=()=>ge(p,"$sessionStore",s),c=()=>ge(U,"$loading",s);let y=le(r,"data",8);const p=_e(y().session),U=_e(!0);re.auth.getSession().then(async({data:{session:a},error:n})=>{console.log("Client session loaded at:",new Date().toISOString()),n&&console.error("Session load error:",n.message),I(p,a||y().session),I(U,!1)}).catch(a=>{console.error("Session load error:",a),I(p,null),I(U,!1)}),re.auth.onAuthStateChange((a,n)=>{var T;console.log("Layout auth state changed:",a,(T=n==null?void 0:n.user)==null?void 0:T.email),I(p,n),a==="SIGNED_OUT"&&(console.log("User signed out, redirecting to /"),ie("/",{replaceState:!0}))});async function Z(){if(S()){console.log("Initiating sign out");try{const{error:a}=await re.auth.signOut();if(a)throw console.error("Sign out error:",a.message),a;console.log("Signed out successfully"),I(p,null),ie("/",{replaceState:!0})}catch(a){console.error("Sign out failed:",a)}}}we();var m=Fe();ze(a=>{var n=We(),T=g(j(n),22);{var H=Y=>{var t=Ve();g(j(t)),o(Y,t)};N(T,Y=>{Y(H)})}o(a,n)});var V=g(j(m),2);{var ee=a=>{var n=Je();o(a,n)},ae=a=>{var n=Ke(),T=j(n);Ze(T,{get session(){return S()},onAuthToggle:Z});var H=g(T,2);Ne(H,r,"default",{}),o(a,n)};N(V,a=>{c()?a(ee):a(ae,!1)})}o(d,m),xe(),_()}export{ga as component,fa as universal};
